# 基于矩阵补全的推荐系统实验报告

---

## 一、研究背景与问题建模

在现代推荐系统中，用户–物品评分矩阵通常具有两个显著特征：

1. **高度稀疏**：绝大多数用户仅对极少数物品进行过评分；
2. **潜在低秩结构**：用户偏好与物品属性可由少量潜在因子刻画。

矩阵补全（Matrix Completion）问题正是基于上述特征提出，其核心目标是在**仅观测部分矩阵元素**的条件下，恢复完整评分矩阵。

本实验基于 **MovieLens 10M** 数据集，分别采用：

- 基于核范数最小化的**凸优化方法（SVT）**
- 基于低秩分解的**非凸方法（Matrix Factorization）**

并通过 **5 折交叉验证** 比较不同方法在预测精度与工程可扩展性方面的表现。

---

## 二、数据集与实验设置

### 2.1 数据集说明

实验采用 **MovieLens 10M** 数据集，该数据集是推荐系统领域的经典基准数据集，包含约：

- 1000 万条用户–电影评分记录  
- 评分范围：1–5  

### 2.2 子矩阵采样策略

考虑到核范数方法在大规模矩阵上的计算复杂度，本实验在保证数据统计特征不发生明显变化的前提下，选取部分用户与电影构造子矩阵进行实验。

实验参数设置如下：

- **数据集**：MovieLens 10M  
- **用户数**：5000  
- **电影数**：3000  
- **评价指标**：RMSE  
- **交叉验证**：5 折  
- **矩阵分解秩**：\( r = 20 \)

---

## 三、问题建模（Problem Formulation）

设  $$M \in \mathbb{R}^{n \times m}$$  为用户–电影评分矩阵，仅在索引集合  $$\Omega$$ 上可观测。

矩阵补全问题可以形式化为以下优化问题：

 $$\min_X \sum_{(i,j)\in\Omega} (X_{ij} - M_{ij})^2$$

$$
\text{s.t. }{rank}(X) \le r
$$

由于秩约束是**非凸的**，直接求解困难，因此后续实验中分别采用：

- **凸松弛方法（核范数最小化）**
- **非凸参数化方法（矩阵分解）**

进行求解。

---

## 四、方法原理与数学模型

### 4.1 SVT 方法（核范数最小化）

SVT（Singular Value Thresholding）方法通过求解如下凸优化问题实现矩阵补全：

$$
\min_X \|X\|_* \quad 
\text{s.t. } X_{ij} = M_{ij}, \ (i,j)\in\Omega
$$

其中：

-  $$\|\cdot\|_*$$ 表示矩阵的**核范数**（奇异值之和）

SVT 算法在每次迭代中执行以下步骤：

1. 对矩阵进行奇异值分解（SVD）： $$Y = U \Sigma V^\top$$

2. 对奇异值进行软阈值操作： $$\Sigma_\tau = \max(\Sigma - \tau, 0)$$

3. 重构低秩矩阵作为当前估计
4. 该方法属于凸优化框架，具有**全局最优解保证**。

---

### 4.2 矩阵分解方法（Matrix Factorization）

矩阵分解方法假设评分矩阵可以表示为两个低秩矩阵的乘积： $$R \approx U V^\top$$

其优化目标函数为： $$\min_{U,V} \sum_{(i,j)\in\Omega} (R_{ij} - U_i^\top V_j)^2+ \lambda (\|U\|_F^2 + \|V\|_F^2)$$

其中：

-  $$U$$ ：用户隐因子矩阵  
-  $$V$$ ：物品隐因子矩阵  
-  $$\lambda$$ ：正则化参数  

本实验采用 **交替最小二乘法（ALS）** 进行优化。

---

## 五、评价指标与实验流程

### 5.1 评价指标

实验采用 **均方根误差（RMSE）** 作为评价指标：

$$
\text{RMSE} =
\sqrt{
\frac{1}{|\Omega_{\text{test}}|}
\sum_{(i,j)\in\Omega_{\text{test}}}
(R_{ij} - \hat{R}_{ij})^2
}
$$

RMSE 能够直观衡量预测评分与真实评分之间的偏差。

---

### 5.2 实验流程

整体实验流程如下：

1. 数据加载与用户 / 物品索引映射  
2. 构造稀疏评分矩阵  
3. 划分训练集与测试集（5 折交叉验证）  
4. 分别训练 SVT 与 MF 模型  
5. 在测试集上计算 RMSE  

---

## 六、实验结果与运行现象分析

### 6.1 SVT 方法运行结果

SVT 方法在迭代过程中，其估计矩阵的**秩逐步下降**，表明核范数约束有效推动了解向低秩结构收缩。

- 迭代次数：约 50 次  
- 最终 RMSE：约 **3.54**

---

### 6.2 矩阵分解方法运行结果

矩阵分解方法在约 **20 次迭代内即可收敛**，最终预测性能显著优于 SVT：

- 最终 RMSE：约 **1.15**

从运行效率角度看，矩阵分解方法的训练时间明显短于 SVT。

---

## 七、时间复杂度与工程可扩展性分析

从时间复杂度角度分析：

- **SVT 方法**  
  - 每次迭代需进行大规模奇异值分解  
  - 时间复杂度近似为：    $O(rmn)$
  - 当矩阵规模较大时，计算代价成为主要瓶颈  

- **矩阵分解方法**  
  - 每次迭代仅涉及低维矩阵运算  
  - 复杂度主要与隐因子维度 $k$ 成正比  
  - 更适合大规模推荐系统场景  

---

## 八、讨论与方法适用性比较

SVT 方法在凸优化框架下具有严格的全局最优性保证，适合作为矩阵补全问题的**理论基准方法**。

然而，在推荐系统实际场景中：

- 其预测精度不占优势  
- 计算效率较低  

相比之下，矩阵分解方法虽然为非凸优化问题，但在合理正则化与参数设置下：

- 具有更优的预测性能  
- 具备良好的工程可扩展性  

因此成为工业界推荐系统的主流方案。

---

## 九、结论与总结

本文在 MovieLens 10M 数据集上，对比了基于核范数最小化的 SVT 方法与基于低秩分解的矩阵分解方法。

实验结果表明：

- 矩阵分解方法在预测精度与计算效率方面均明显优于 SVT  
- SVT 更适合作为理论研究中的对照方法  
- 在大规模推荐系统中，低秩矩阵分解方法更具实际应用价值  

---
