# 基于矩阵补全的推荐系统实验报告

---

## 一、研究背景与问题建模

在现代推荐系统中，用户–物品评分矩阵通常具有两个显著特征：

1. **高度稀疏**：绝大多数用户仅对极少数物品进行过评分；
2. **潜在低秩结构**：用户偏好与物品属性可由少量潜在因子刻画。

矩阵补全（Matrix Completion）问题正是基于上述特征提出，其核心目标是在**仅观测部分矩阵元素**的条件下，恢复完整评分矩阵。

本实验基于 **MovieLens 10M** 数据集，分别采用：

- soft-impute的凸方法
- AM的非凸方法

并通过 **5 折交叉验证** 比较不同方法在预测精度与工程可扩展性方面的表现。

---

## 二、数据集与实验设置

### 2.1 数据集说明

实验采用 **MovieLens 10M** 数据集，该数据集是推荐系统领域的经典基准数据集，包含约：

- 1000 万条用户–电影评分记录  
- 评分范围：1–5  

## 1. 实验环境与数据集说明

本实验基于 **MovieLens 10M** 数据集开展。该数据集包含约 **1000 万条用户–电影评分记录**，是推荐系统与矩阵填充领域中广泛使用的基准数据集。评分范围为 0.5–5.0，具有用户规模大、评分矩阵高度稀疏等特点，适合用于评估矩阵分解算法在大规模场景下的性能。

在数据预处理阶段，将原始的用户 ID 与电影 ID 重新编码为连续整数索引，以便构建用户–物品评分矩阵并提高计算效率。实验采用 **5 折交叉验证（5-fold Cross Validation）** 进行评估，每一折中使用 80% 的数据作为训练集，20% 作为测试集，以减小数据划分带来的随机性影响。

模型性能评价指标采用 **均方根误差（RMSE）**，其定义如下：

$$
\mathrm{RMSE} = \sqrt{\frac{1}{N} \sum_{(u,i)\in\Omega} \left(r_{ui} - \hat{r}_{ui}\right)^2}
$$

其中， $r_{ui}$ 表示真实评分， $\hat{r}_{ui}$ 表示模型预测评分， $\Omega$ 为观测评分集合。

---

## 三、问题建模（Problem Formulation）

设  $$M \in \mathbb{R}^{n \times m}$$  为用户–电影评分矩阵，仅在索引集合  $$\Omega$$ 上可观测。

矩阵补全问题可以形式化为以下优化问题：

 $$\min_X \sum_{(i,j)\in\Omega} (X_{ij} - M_{ij})^2$$

$$
\text{s.t. }{rank}(X) \le r
$$

由于秩约束是**非凸的**，直接求解困难，因此后续实验中分别采用：

- **凸松弛方法（soft-impute）**
- **非凸参数化方法（AM）**

进行求解。

---
 **下面是我写的**
 
# 四、实验设置与参数选择说明

## 1.soft-impute算法设置


## 2. 交替最小化（AM）算法设置

本实验采用 **交替最小化（Alternating Minimization, AM）** 方法对低秩矩阵分解模型进行求解。该方法通过在固定其中一个因子矩阵的条件下，交替优化另一个因子矩阵，将原始的非凸优化问题分解为一系列带正则化的最小二乘子问题。

模型目标函数形式如下：

$$
\min_{U,V} \sum_{(u,i)\in\Omega} \left(r_{ui} - U_u^\top V_i\right)^2 + \lambda \left( \|U\|_F^2 + \|V\|_F^2 \right)
$$

其中， $U \in \mathbb{R}^{n \times r}$ 与 $V \in \mathbb{R}^{m \times r}$ 分别表示用户与物品的潜在因子矩阵， $r$ 为矩阵分解秩（rank）， $\lambda$ 为正则化参数。

---

## 3. 参数选择与调优策略

### 3.1 矩阵秩（rank）的选择

矩阵秩 $r$ 决定了潜在因子空间的维度，是影响模型表达能力与泛化性能的关键参数。本实验对不同秩设置进行了对比分析，主要考察了 $r=20$ 与 $r=50$ 两种典型配置。

实验结果表明：

- 当 $r=20$ 时，模型在测试集上取得了较低的 RMSE（约 **0.89**），且收敛速度较快；
- 当 $r=50$ 时，模型复杂度显著增加，但测试集 RMSE 反而上升，表明模型可能出现过拟合现象。

综合考虑预测性能与计算效率，本文最终选择 **$r=20$** 作为主要实验设置。

---

### 3.2 正则化参数（ $\lambda$ ）的设置

正则化参数 $\lambda$ 用于约束潜在因子矩阵的范数，防止模型参数过大导致的过拟合问题。参考相关文献并结合初步实验结果，本文将正则化参数设置为：

$$
\lambda = 0.1
$$

在该设置下，模型在训练误差与测试误差之间表现出较好的平衡。由于本实验重点在于算法行为分析，因此未对 $\lambda$ 进行大规模网格搜索，而是采用文献中常用的经验值。

---

### 3.3 自适应收敛条件设计

在初始实验中，本文采用固定最大迭代次数作为 **交替最小化**（Alternating Minimization, AM）算法的停止条件，并将最大迭代次数设为 **15 次**。该设置能够保证算法在所有折次中充分迭代，但在实际运行中观察到，模型在若干轮迭代后训练误差的下降幅度已经非常有限，后续迭代对预测性能的提升并不明显，却显著增加了计算时间。

为此，本文在固定迭代次数方案的基础上，引入了一种**基于训练误差变化的自适应收敛准则**。具体而言，在第 \( t \) 次迭代结束后，若训练集 RMSE 的相对变化满足：

$$
\frac{|\mathrm{RMSE}_t - \mathrm{RMSE}_{t-1}|}{\mathrm{RMSE}_{t-1}} < \varepsilon,
$$

则认为模型已基本收敛，并提前终止迭代。本实验中收敛阈值设置为：

$$
\varepsilon = 10^{-3}.
$$

同时，为避免极端情况下算法震荡或无法收敛，仍设置最大迭代次数上限为 **50 次** 作为安全约束。

在实际实验过程中发现，当阈值设置为 $10^{-3}$ 时，模型通常在 **约 18–20** 次迭代后自动停止。与固定迭代次数为 15 的方案相比，自适应停止策略在部分折次中会进行略多于 15 次的迭代，但此后训练误差的相对变化已降至  $10^{-3}$  量级，RMSE 曲线趋于平缓，继续迭代带来的性能提升极为有限。

总体而言，引入自适应收敛条件后，算法能够根据误差收敛情况自动决定停止时机，在保证预测精度与固定迭代次数方案基本一致的前提下，避免了不必要的冗余迭代，为大规模矩阵填充任务提供了一种更加稳健且具有实践意义的停止策略。


---

## 4. 小结

综上所述，本文通过合理选择矩阵秩与正则化参数，并引入基于误差变化的自适应停止条件，有效提升了交替最小化算法在大规模稀疏评分数据上的计算效率与稳定性。上述参数设置在后续实验中保持一致，以确保实验结果的可比性与可靠性。



---

## 五、评价指标与实验流程

### 5.1 评价指标

实验采用 **均方根误差（RMSE）** 作为评价指标：

$$
\text{RMSE} =
\sqrt{
\frac{1}{|\Omega_{\text{test}}|}
\sum_{(i,j)\in\Omega_{\text{test}}}
(R_{ij} - \hat{R}_{ij})^2
}
$$

RMSE 能够直观衡量预测评分与真实评分之间的偏差。

---



